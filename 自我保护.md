---
title: 自我保护
date: 2019-01-01 00:00:00
tags: ["设计"]
---

系统的处理能力都有一个上限，这个可能是受硬件能力限制，如其所在的服务器硬件性能，网络带宽能力；

可能是受下游系统的能力限制，如后端连接的数据库并发能力；也可能是为了保护自己的核心功能。

系统自保护是一个非常重要的功能，它可以防止单点问题扩大化、瞬时问题长尾化，以及非关键问题灾难化。

业务系统调用各种其他系统时应该有面向失败的设计，不要无条件的相信其他系统，设计一套自己的容错方案。系统设计的一个重要原则是认为所有的依赖都是不靠谱的，基于此原则做依赖管理。

【最佳实践】

1. 通过 TCP 滑动窗口和拥塞控制等机制来缓解请求拥塞的情况。
2. 服务端要借助限流组件，合理地配置限流规则，来应对突发的大流量，防止被流量洪峰打垮。
3. 客户端对不稳定或超长时间的调用进行自动熔断，配置合理的超时时间，防止被不稳定下游服务阻塞而导致级联失败。
4. 限流是为了减少业务流量，降低系统压力。限流的处理逻辑应简单快速，不应加剧系统开销